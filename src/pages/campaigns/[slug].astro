---
import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { campaigns } from '../../campaigns';

export async function getStaticPaths() {
  return campaigns.map((c) => ({
    params: { slug: c.id },
    props: { campaign: c },
  }));
}

const { campaign } = Astro.props;
const isAcroterra = campaign.id === 'acroterra';
const pdfSrc = '/acroterra.pdf';
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={campaign.title} description={campaign.blurb} />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      :root { --bg:#0b0f1a; --ink:#fff; --edge:rgba(255,255,255,.15); }
      html,body { height:100% }
      body {
        margin:0;
        color:var(--ink);
        font:16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif;
        background:#0b0f1a url('/Mountains.png') center/cover fixed no-repeat;
      }
      main { width:min(1200px,94%); margin:24px auto; }

      .hero { margin-bottom:12px; }
      .hero img {
        display: block;
        margin: 0 auto;
        width: 100%;
        max-width: 1000px;
        height: auto;
        border-radius: 16px;
        object-fit: contain;
        background-color: #000;
      }
      .title {
        margin:12px 0 6px;
        font-size:clamp(24px,3.6vw,40px);
        color:#ffffff;
        text-align: center;
      }
      .sub { opacity:.9; margin:0 0 12px; text-align: center; }

      .toolbar {
        display:flex;
        flex-wrap:wrap;
        gap:12px;
        align-items:center;
        justify-content:center;
        margin:12px auto 16px;
        max-width:1000px;
      }
      .btn {
        appearance:none;
        border:1px solid var(--edge);
        background: rgba(255,255,255,.08);
        color:#fff;
        padding:8px 12px;
        border-radius:10px;
        text-decoration:none;
        font-size:14px;
        transition: background .2s, border-color .2s, transform .15s;
      }
      .btn:hover {
        border-color:#fff;
        background: rgba(255,255,255,.15);
        transform: translateY(-1px);
      }

      .vtt-btn {
        display:inline-flex;
        align-items:center;
        gap:8px;
        padding:14px 28px;
        font-size:1.1rem;
        font-weight:600;
        color:#fff;
        background:#5b2b82;
        border:none;
        border-radius:12px;
        text-decoration:none;
        box-shadow:0 6px 16px rgba(0,0,0,0.35);
        transition: background-color .2s ease, transform .15s ease, box-shadow .2s ease;
      }
      .vtt-btn:hover {
        background:#7d42aa;
        transform:translateY(-2px);
        box-shadow:0 10px 22px rgba(0,0,0,0.45);
      }
      .vtt-btn svg { flex-shrink:0; }

      /* Centered, transparent, scrollbar-hidden PDF viewer */
      .pdf-wrap {
        display: flex;
        justify-content: center;
        margin: 24px auto;
        width: 96vw;
        max-width: none;
        height: 200vh;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0,0,0,.4);
        border: 1px solid var(--edge);
        background: transparent;
      }
      .pdf {
        width: 100%;
        height: 100%;
        border: 0;
        background: transparent;
        scrollbar-width: none; /* Firefox */
      }
      .pdf::-webkit-scrollbar {
        display: none; /* WebKit */
      }
    </style>
  </head>
  <body>
    <Header />
    <main>
      <section class="hero">
        <img src={campaign.image} alt={`${campaign.title} banner`} />
        <h1 class="title">{campaign.title}</h1>
        <p class="sub">{campaign.schedule}</p>

        <div class="toolbar">
          {isAcroterra && (
            <>
              <a class="btn" href={pdfSrc} target="_blank" rel="noopener">Open in new tab</a>
              <a class="btn" href={pdfSrc} download>Download PDF</a>
            </>
          )}
          <a class="vtt-btn" href="https://play.questwithwasem.com" target="_blank" rel="noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#ffd166" viewBox="0 0 24 24">
              <path d="M12 2 2 9l10 13 10-13-10-7Zm0 2.3L19.1 9H4.9L12 4.3Zm0 15.9-7.16-9.3h14.32L12 20.2Z"/>
            </svg>
            Go to Virtual Table Top
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#ffd166" viewBox="0 0 24 24">
              <path d="M12 2 2 9l10 13 10-13-10-7Zm0 2.3L19.1 9H4.9L12 4.3Zm0 15.9-7.16-9.3h14.32L12 20.2Z"/>
            </svg>
          </a>
        </div>
      </section>

      {isAcroterra ? (
        <div class="pdf-wrap">
          <iframe
            class="pdf"
            src={`${pdfSrc}#view=FitH&page=1&toolbar=1&navpanes=1`}
            title="Acroterra Guide PDF"
          ></iframe>
        </div>
      ) : (
        <section>
          <p>{campaign.blurb}</p>
        </section>
      )}
    </main>
    <Footer />
  </body>
</html>
