---
import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';

// Data
import { campaigns } from '../../campaigns';
import { acroterraGuide } from '../../guides/acroterra';

export async function getStaticPaths() {
  return campaigns.map((c) => ({
    params: { slug: c.id },
    props: { campaign: c },
  }));
}

const { campaign } = Astro.props;
const isAcroterra = campaign.id === 'acroterra';
---

<!doctype html>
<html lang="en">
<head>
  <BaseHead title={campaign.title} description={campaign.blurb} />
  <style>
    :root {
      --bg: #0b0f1a;
      --ink: #f5f6ff;
      --panel: rgba(0,0,0,0.6);
      --edge: rgba(255,255,255,0.15);
      --shadow: 0 0 24px rgba(0,0,0,0.4);
      --backdrop: blur(4px);
    }
    html, body {
      margin: 0; padding: 0;
      min-height: 100%;
      background: var(--bg) url('/Mountains.png') center/cover fixed no-repeat;
      font-family: system-ui, sans-serif;
      color: var(--ink);
    }
    main {
      width: min(1200px, 94%);
      margin: 2rem auto;
    }
    h1 {
      font-size: 2.4rem;
      margin-bottom: 0.25rem;
    }
    .schedule {
      opacity: 0.9;
      margin-bottom: 2rem;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
    }
    .panel {
      background: var(--panel);
      border: 1px solid var(--edge);
      border-radius: 18px;
      box-shadow: var(--shadow);
      overflow: hidden;
      backdrop-filter: var(--backdrop);
      display: flex;
      flex-direction: column;
    }
    .panel h3 {
      margin: 0;
      padding: 12px 16px;
      font-size: 18px;
      letter-spacing: .3px;
      background: #ffffff;     /* white header */
      color: #0b0f1a;          /* dark text */
    }
    .panel .body {
      padding: 16px;
      line-height: 1.6;
    }
    .item {
      margin-bottom: 1rem;
    }
    .item-title {
      font-weight: bold;
      margin-bottom: 0.25rem;
    }
    .hero-img {
      width: 100%;
      max-height: 320px;
      object-fit: cover;
      border-radius: 16px;
      margin-bottom: 1.5rem;
    }
  </style>
</head>
<body>
  <Header />
  <main>
    <img src={campaign.image} alt={`${campaign.title} banner`} class="hero-img" />
    <h1>{campaign.title}</h1>
    <div class="schedule">{campaign.schedule}</div>

    {isAcroterra ? (
      <section class="grid">
        {acroterraGuide.panels.map((p) => (
          <article class="panel">
            <h3>{p.title}</h3>
            <div class="body">
              {p.body && <p>{p.body}</p>}
              {p.items && p.items.map((it) => (
                <div class="item">
                  {it.title && (
                    <div class="item-title">
                      {it.title}
                      {it.subtitle && <span> â€¢ {it.subtitle}</span>}
                    </div>
                  )}
                  <div>{it.body}</div>
                </div>
              ))}
            </div>
          </article>
        ))}
      </section>
    ) : (
      <div>
        <p>{campaign.blurb}</p>
      </div>
    )}
  </main>
  <Footer />
</body>
</html>
