---
import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { campaigns } from '../../campaigns';

export async function getStaticPaths() {
  return campaigns.map((c) => ({
    params: { slug: c.id },
    props: { campaign: c },
  }));
}

const { campaign } = Astro.props;
const isAcroterra = campaign.id === 'acroterra';

// PDF path in /public
const pdfSrc = '/acroterra.pdf';
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={campaign.title} description={campaign.blurb} />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      :root{ --bg:#0b0f1a; --ink:#fff; --edge:rgba(255,255,255,.15); }
      html,body{height:100%}
      body{
        margin:0; color:var(--ink);
        font:16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif;
        background:#0b0f1a url('/Mountains.png') center/cover fixed no-repeat;
      }
      main{ width:min(1200px,94%); margin:24px auto; }

      .hero{ margin-bottom:12px; }
      .hero img{ width:100%; max-height:300px; object-fit:cover; border-radius:16px; display:block; }
      .title{ margin:12px 0 6px; font-size:clamp(24px,3.6vw,40px) }
      .sub{ opacity:.9; margin:0 0 12px }

      .toolbar{
        display:flex; gap:10px; align-items:center; justify-content:flex-end;
        margin:10px 0 14px;
      }
      .btn{
        appearance:none; border:1px solid var(--edge);
        background: rgba(255,255,255,.08); color:#fff; padding:8px 12px;
        border-radius:10px; text-decoration:none; font-size:14px;
      }
      .btn:hover{ border-color:#fff; }

      .pdf-wrap{
        height: calc(200vh - 240px); /* Taller to fit almost full page */
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0,0,0,.4);
        border: 1px solid var(--edge);
        background: rgba(0,0,0,.4);
      }
      .pdf{ width:100%; height:100%; border:0; }
    </style>
  </head>
  <body>
    <Header />
    <main>
      <section class="hero">
        <img src={campaign.image} alt={`${campaign.title} banner`} />
        <h1 class="title">{campaign.title}</h1>
        <p class="sub">{campaign.schedule}</p>

        {isAcroterra && (
          <div class="toolbar">
            <a class="btn" href={pdfSrc} target="_blank" rel="noopener">Open in new tab</a>
            <a class="btn" href={pdfSrc} download>Download PDF</a>
          </div>
        )}
      </section>

      {isAcroterra ? (
        <div class="pdf-wrap">
          <!-- Built-in browser PDF viewer -->
          <iframe
            class="pdf"
            src={`${pdfSrc}#view=FitH&page=1&toolbar=1&navpanes=1`}
            title="Acroterra Guide PDF"
          ></iframe>
        </div>
      ) : (
        <section>
          <p>{campaign.blurb}</p>
        </section>
      )}
    </main>
    <Footer />
  </body>
</html>
